%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                            %%
%% thesistemplate.tex version 3.20 (2018/08/31)                               %%
%% The LaTeX template file to be used with the aaltothesis.sty (version 3.20) %%
%% style file.                                                                %%
%% This package requires pdfx.sty v. 1.5.84 (2017/05/18) or newer.            %%
%%                                                                            %%
%% This is licensed under the terms of the MIT license below.                 %%
%%                                                                            %%
%% Written by Luis R.J. Costa.                                                %%
%% Currently developed at the Learning Services of Aalto University School of %%
%% Electrical Engineering by Luis R.J. Costa since May 2017.                  %%
%%                                                                            %%
%% Copyright 2017-2018, by Luis R.J. Costa, luis.costa@aalto.fi,              %%
%% Copyright 2017-2018 Swedish translations in aaltothesis.cls by Elisabeth   %%
%% Nyberg, elisabeth.nyberg@aalto.fi and Henrik Wall√©n,                       %%
%% henrik.wallen@aalto.fi.                                                    %%
%% Copyright 2017-2018 Finnish documentation in the template opinnatepohja.tex%%
%% by Perttu Puska, perttu.puska@aalto.fi, and Luis R.J. Costa.               %%
%% Copyright 2018 English template thesistemplate.tex by Luis R.J. Costa.     %%
%% Copyright 2018 Swedish template kandidatarbetsbotten.tex by Henrik Wallen. %%
%%                                                                            %%
%% Permission is hereby granted, free of charge, to any person obtaining a    %%
%% copy of this software and associated documentation files (the "Software"), %%
%% to deal in the Software without restriction, including without limitation  %%
%% the rights to use, copy, modify, merge, publish, distribute, sublicense,   %%
%% and/or sell copies of the Software, and to permit persons to whom the      %%
%% Software is furnished to do so, subject to the following conditions:       %%
%% The above copyright notice and this permission notice shall be included in %%
%% all copies or substantial portions of the Software.                        %%
%% THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR %%
%% IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,   %%
%% FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL    %%
%% THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER %%
%% LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING    %%
%% FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER        %%
%% DEALINGS IN THE SOFTWARE.                                                  %%
%%                                                                            %%
%%                                                                            %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                                                            %%
%%                                                                            %%
%% An example for writting your thesis using LaTeX                            %%
%% Original version and development work by Luis Costa, changes to the text   %% 
%% in the Finnish template by Perttu Puska.                                   %%
%% Support for Swedish added 15092014                                         %%
%% PDF/A-b support added on 15092017                                          %%
%% PDF/A-2 support added on 24042018                                          %%
%%                                                                            %%
%% This example consists of the files                                         %%
%%         thesistemplate.tex (version 3.20) (for text in English)            %%
%%         opinnaytepohja.tex (version 3.20) (for text in Finnish)            %%
%%         kandidatarbetsbotten.tex (version 1.00) (for text in Swedish)      %%
%%         aaltothesis.cls (versio 3.20)                                      %%
%%         kuva1.eps (graphics file)                                          %%
%%         kuva2.eps (graphics file)                                          %%
%%         kuva1.jpg (graphics file)                                          %%
%%         kuva2.jpg (graphics file)                                          %%
%%         kuva1.png (graphics file)                                          %%
%%         kuva2.png (graphics file)                                          %%
%%         kuva1.pdf (graphics file)                                          %%
%%         kuva2.pdf (graphics file)                                          %%
%%                                                                            %%
%%                                                                            %%
%% Typeset in Linux either with                                               %%
%% pdflatex: (recommended method)                                             %%
%%             $ pdflatex thesistemplate                                      %%
%%             $ pdflatex thesistemplate                                      %%
%%                                                                            %%
%%   The result is the file thesistemplate.pdf that is PDF/A compliant, if    %%
%%   you have chosen the proper \documenclass options (see comments below)    %%
%%   and your included graphics files have no problems.
%%                                                                            %%
%% Or                                                                         %%
%% latex: (this method is not recommended)                                    %%
%%             $ latex thesistemplate                                         %%
%%             $ latex thesistemplate                                         %%
%%                                                                            %%
%%   The result is the file thesistemplate.dvi, which is converted to ps      %%
%%   format as follows:                                                       %%
%%                                                                            %%
%%             $ dvips thesistemplate -o                                      %%
%%                                                                            %%
%%   and then to pdf as follows:                                              %%
%%                                                                            %%
%%             $ ps2pdf thesistemplate.ps                                     %%
%%                                                                            %%
%%   This pdf file is not PDF/A compliant. You must must make it so using,    %%
%%   e.g., Acrobat Pro or PDF-XChange.                                        %%
%%                                                                            %%
%%                                                                            %%
%% Explanatory comments in this example begin with the characters %%, and     %%
%% changes that the user can make with the character %                        %%
%%                                                                            %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%
%% WHAT is PDF/A
%%
%% PDF/A is the ISO-standardized version of the pdf. The standard's goal is to
%% ensure that he file is reproducable even after a long time. PDF/A differs
%% from pdf in that it allows only those pdf features that support long-term
%% archiving of a file. For example, PDF/A requires that all used fonts are
%% embedded in the file, whereas a normal pdf can contain only a link to the
%% fonts in the system of the reader of the file. PDF/A also requires, among
%% other things, data on colour definition and the encryption used.
%% Currently three PDF/A standards exist:
%% PDF/A-1: based on PDF 1.4, standard ISO19005-1, published in 2005.
%%          Includes all the requirements essential for long-term archiving.
%% PDF/A-2: based on PDF 1.7, standard ISO19005-2, published in 2011.
%%          In addition to the above, it supports embedding of OpenType fonts,
%%          transparency in the colour definition and digital signatures.
%% PDF/A-3: based on PDF 1.7, standard ISO19005-3, published in 2012.
%%          Differs from the above only in that it allows embedding of files in
%%          any format (e.g., xml, csv, cad, spreadsheet or wordprocessing
%%          formats) into the pdf file.
%% PDF/A-1 files are not necessarily PDF/A-2 -compatible and PDF/A-2 are not
%% necessarily PDF/A-1 -compatible.
%% All of the above PDF/A standards have two levels:
%% b: (basic) requires that the visual appearance of the document is reliably
%%    reproduceable.
%% a (accessible) in addition to the b-level requirements, specifies how
%%   accessible the pdf file is to assistive software, say, for the physically
%%   impaired.
%% For more details on PDF/A, see, e.g., https://en.wikipedia.org/wiki/PDF/A
%%
%%
%% WHICH PDF/A standard should my thesis conform to?
%%
%% Primarily to the PDF/A-1b standard. All the figures and graphs typically
%% use in thesis work do not require transparency features, a basic '2-D'
%% visualisation suffices. The font to be used are specified in this template
%% and they should not be changed. However, if you have figures where
%% transparency characteristics matter, use the PDF/A-2b standard. Do not use
%% the PDF/A-3b standard for your thesis.
%%
%%
%% WHAT graphics format can I use to produce my PDF/A compliant file?
%%
%% When using pdflatex to compile your work, use jpg, png or pdf files. You may
%% have PDF/A compliance problems with figures in pdf format. Do not use PDF/A
%% compliant graphics files.
%% If you decide to use latex to compile your work, the only acceptable file
%% format for your figure is eps. DO NOT use the ps format for your figures.

%% USE one of these:
%% * the first when using pdflatex, which directly typesets your document in the
%%   chosen pdf/a format and you want to publish your thesis online,

%% * the second when you want to print your thesis to bind it, or
%% * the third when producing a ps file and a pdf/a from it.
%%
\documentclass[english, 12pt, a4paper, elec, utf8, a-1b, online]{aaltothesis}
%\documentclass[english, 12pt, a4paper, elec, utf8, a-1b]{aaltothesis}
%\documentclass[english, 12pt, a4paper, elec, dvips, online]{aaltothesis}

%% Use the following options in the \documentclass macro above:
%% your school: arts, biz, chem, elec, eng, sci
%% the character encoding scheme used by your editor: utf8, latin1
%% thesis language: english, finnish, swedish
%% make an archiveable PDF/A-1b or PDF/A-2b compliant file: a-1b, a-2b
%%                    (with pdflatex, a normal pdf containing metadata is
%%                     produced without the a-*b option)
%% typeset in symmetric layout and blue hypertext for online publication: online
%%            (no option is the default, resulting in a wide margin on the
%%             binding side of the page and black hypertext)
%% two-sided printing: twoside (default is one-sided printing)
%%

%% Use one of these if you write in Finnish (see the Finnish template
%% opinnaytepohja.tex)
%\documentclass[finnish, 12pt, a4paper, elec, utf8, a-1b, online]{aaltothesis}
%\documentclass[finnish, 12pt, a4paper, elec, utf8, a-1b]{aaltothesis}
%\documentclass[finnish, 12pt, a4paper, elec, dvips, online]{aaltothesis}

\usepackage{graphicx}
\usepackage{cite}

%% Math fonts, symbols, and formatting; these are usually needed
\usepackage{amsfonts,amssymb,amsbsy,amsmath}

\usepackage{enumerate}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{tikz-3dplot}
\usepackage{hyperref}
\usepackage{pgfplots}
\usepackage{siunitx}

\usepackage{booktabs}
\usepackage{pdflscape}
\usepackage[pass]{geometry}

\usepackage{bm}


\usepackage{url}
\def\UrlBreaks{\do\/\do-}

%% Change the school field to specify your school if the automatically set name
%% is wrong
% \university{aalto-yliopisto}
% \school{S√§hk√∂tekniikan korkeakoulu}

%% Edit to conform to your degree programme
%%
\degreeprogram{Master's Programme in Automation and Electrical Engineering}
%%

%% Your major
%%
\major{Electronic and Digital Systems}
%%

%% Major subject code
%%
\code{ELEC3060}
%%
 
%% Choose one of the three below
%%
%\univdegree{BSc}
\univdegree{MSc}
%\univdegree{Lic}
%%

%% Your name (self explanatory...)
%%
\thesisauthor{Markus S√§ynevirta}
%%

%% Your thesis title comes here and possibly again together with the Finnish or
%% Swedish abstract. Do not hyphenate the title, and avoid writing too long a
%% title. Should LaTeX typeset a long title unsatisfactorily, you mght have to
%% force a linebreak using the \\ control characters.
%% In this case...
%% Remember, the title should not be hyphenated!
%% A possible "and" in the title should not be the last word in the line, it
%% begins the next line.
%% Specify the title again without the linebreak characters in the optional
%% argument in box brackets. This is done because the title is part of the 
%% metadata in the pdf/a file, and the metadata cannot contain linebreaks.
%%

%% Uplink Interception of Very Small Aperture Satellite Terminals from Aerial Platforms

\thesistitle{Uplink security against airborne adversaries in non-geostationary satellite communications}
%\thesistitle[Title of the thesis]{Title of\\ the thesis}
%%

%%
\place{Espoo}
%%

%% The date for the bachelor's thesis is the day it is presented
%%
\date{31.12.2023}
%%

%% Thesis supervisor
%% Note the "\" character in the title after the period and before the space
%% and the following character string.
%% This is because the period is not the end of a sentence after which a
%% slightly longer space follows, but what is desired is a regular interword
%% space.
%%
\supervisor{Asst. Prof.\ Jaan Praks}
%%

%% Advisor(s)---two at the most---of the thesis. Check with your supervisor how
%% many official advisors you can have.
%%
\advisor{M. Sc. (Tech) Tapio Savunen}
%\advisor{MSc Sarah Scientist}
%%

%% Aaltologo: syntax:
%% \uselogo{aaltoRed|aaltoBlue|aaltoYellow|aaltoGray|aaltoGrayScale}{?|!|''}
%% The logo language is set to be the same as the thesis language.
%%
\uselogo{aaltoBlack}{!}
%%

%% The English abstract:
%% All the details (name, title, etc.) on the abstract page appear as specified
%% above.
%% Thesis keywords:
%% Note! The keywords are separated using the \spc macro
%%
\keywords{For keywords choose\spc concepts that are\spc central to your\spc thesis}
%%

%% The abstract text. This text is included in the metadata of the pdf file as well
%% as the abstract page.
%%
\thesisabstract{
Your abstract in English. Keep the abstract short. The abstract explains your 
research topic, the methods you have used, and the results you obtained. In the 
PDF/A format of this thesis, in addition to the abstract page, the abstract text is 
written into the pdf file's metadata. Write here the text that goes into the 
metadata. The metadata cannot contain special characters, linebreak or paragraph 
break characters, so these must not be used here. If your abstract does not contain 
special characters and it does not require paragraphs, you may take advantage of 
the abstracttext macro (see the comment below). Otherwise, the metadata abstract 
text must be identical to the text on the abstract page.
}

%% Copyright text. Copyright of a work is with the creator/author of the work
%% regardless of whether the copyright mark is explicitly in the work or not.
%% You may, if you wish, publish your work under a Creative Commons license (see
%% creaticecommons.org), in which case the license text must be visible in the
%% work. Write here the copyright text you want. It is written into the metadata
%% of the pdf file as well.
%% Syntax:
%% \copyrigthtext{metadata text}{text visible on the page}
%% 
%% In the macro below, the text written in the metadata must have a \noexpand
%% macro before the \copyright special character, and macros (\copyright and
%% \year here) must be separated by the \ character (space chacter) from the
%% text that follows. The macros in the argument of the \copyrighttext macro
%% automatically insert the year and the author's name. (Note! \ThesisAuthor is
%% an internal macro of the aaltothesis.cls class file).
%% Of course, the same text could have simply been written as
%% \copyrighttext{Copyright \noexpand\copyright\ 2018 Eddie Engineer}
%% {Copyright \copyright{} 2018 Eddie Engineer}
%%
\copyrighttext{Copyright \noexpand\copyright\ \number\year\ \ThesisAuthor}
{Copyright \copyright{} \number\year{} \ThesisAuthor}

%% You can prevent LaTeX from writing into the xmpdata file (it contains all the 
%% metadata to be written into the pdf file) by setting the writexmpdata switch
%% to 'false'. This allows you to write the metadata in the correct format
%% directly into the file thesistemplate.xmpdata.
%\setboolean{writexmpdatafile}{false}

%% All that is printed on paper starts here
%%
\begin{document}

%% Create the coverpage
%%
\makecoverpage

%% Typeset the copyright text.
%% If you wish, you may leave out the copyright text from the human-readable
%% page of the pdf file. This may seem like a attractive idea for the printed
%% document especially if "Copyright (c) yyyy Eddie Engineer" is the only text
%% on the page. However, the recommendation is to print this copyright text.
%%
\makecopyrightpage

%% Note that when writting your thesis in English, place the English abstract
%% first followed by the possible Finnish or Swedish abstract.

%% Abstract text
%% All the details (name, title, etc.) on the abstract page appear as specified
%% above.
%%
\begin{abstractpage}[english]
  Your abstract in English. Keep the abstract short. The abstract explains your
  research topic, the methods you have used, and the results you obtained.  
  
  The abstract text of this thesis is written on the readable abstract page as
  well as into the pdf file's metadata via the $\backslash$thesisabstract macro
  (see above). Write here the text that goes onto the readable abstract page.
  You can have special characters, linebreaks, and paragraphs here. Otherwise,
  this abstract text must be identical to the metadata abstract text.
  
  If your abstract does not contain special characters and it does not require
  paragraphs, you may take advantage of the abstracttext macro (see the comment
  below).
\end{abstractpage}

%% The text in the \thesisabstract macro is stored in the macro \abstractext, so
%% you can use the text metadata abstract directly as follows:
%%
%\begin{abstractpage}[english]
%	\abstracttext{} 
%\end{abstractpage}

%% Force a new page so that the possible Finnish or Swedish abstract does not
%% begin on the same page
%%
\newpage
%%
%% Abstract in Finnish.  Delete if you don't need it. 
%%

%%Uplink security of non-geostationary satellite communications against airborne adversaries
\thesistitle{Uplink-liikenteen suojaus vihollisen ilma-aluksia vastaan ei-geostationaarisessa satelliittiviestinn√§ss√§}
\supervisor{Apul. prof.\ Jaan Praks}
\advisor{DI Tapio Savunen}
\degreeprogram{Elektroniikka ja s√§hk√∂tekniikka}
%\department{Elektroniikan ja nanotekniikan laitos}
\major{Elektroniset ja digitaaliset j√§rjestelm√§t}
%% The keywords need not be separated by \spc now.
\keywords{Vastus, resistanssi, l√§mp√∂tila}
%% Abstract text
\begin{abstractpage}[finnish]
  Tiivistelm√§ss√§ on lyhyt selvitys
  kirjoituksen t√§rkeimm√§st√§ sis√§ll√∂st√§: mit√§ ja miten on tutkittu,
  sek√§ mit√§ tuloksia on saatu. 
\end{abstractpage}


%% Preface
%%
%% This section is optional. Remove it if you do not want a preface.
\mysection{Preface}
%\mysection{Esipuhe}
I want to thank Professor Pirjo Professori and my instructor Dr Alan Advisor for 
their good and poor guidance.\\

\vspace{5cm}
Espoo, 31.7.2023

\vspace{5mm}
{\hfill Markus\ S√§ynevirta \hspace{1cm}}

%% Force a new page after the preface
%%
\newpage

%% Table of contents.
%%
\thesistableofcontents

\mysection{Symbols and abbreviations}

\subsection*{Symbols}

\begin{tabular}{ll}
$\mathbf{B}$  & magnetic flux density  \\
$c$              & speed of light in vacuum $\approx 3\times10^8$ [m/s]\\
$\omega_{\mathrm{D}}$    & Debye frequency \\
$\omega_{\mathrm{latt}}$ & average phonon frequency of lattice \\
$\uparrow$       & electron spin direction up\\
$\downarrow$     & electron spin direction down
\end{tabular}

\subsection*{Abbreviations}

\begin{tabular}{ll}
COMINT  & communications intelligence \\
ELINT   & electronic intelligence \\
EO      & earth observation \\
ES      & electromagnetic support \\
FSS     & fixed satellite service \\
GNSS    & global navigation satllite system \\
ISR     & intelligence, surveillance, and reconnaissance \\
MSS     & mobile satellite service \\
NTN     & non-terrestrial network \\
satcom  & satellite communication \\
SIGINT  & signals intelligence
\end{tabular}

\cleardoublepage

\section{Introduction}

%Johdanto, jossa kerrot satelliittteknologian ripe√§st√§ kehittymisest√§ (t√§m√§ jo onkin)
%Viranomaistoimijoiden kiinnostus uusiin LEO-palveluihin - NB/BB-migraatio, laajakaistapalvelut, kaupallisten MNO-verkkojen k√§ytt√∂
%Viranomaisten korkeat tietoturvavaatimukset - muilta osin LEO-palveluilla on hyv√§ vastaavuus vaatimuksiin, tietoturva on merkitt√§v√§ kysymys
%K√§yt√§nn√∂n tietoturvaongelmat satelliittiverkoissa (t√§st√§ on jo suhteellisen paljon)
%Research gap: tutkimusta ei ole tehty riitt√§v√§sti (alueelta, josta ty√∂si on) onko research gap:st√§ evidenssi√§? referenssej√§?
%Ty√∂n kontribuutio (t√§m√§ on t√§rkein osuus johdannossa) - tutkimuskysymykset, ty√∂n rajauksesta, menetelmist√§
%Sis√§lt√∂, rakenne


%% TODO: NGSO vs LEO, termin avaaminen
Over the past five decades, satellite systems have emerged as indispensable enablers of our modern way of life within an increasingly technology-driven human society.
Innovation in fields such as Global Navigation Satellite Systems (GNSS) \cite{oconnor2019economic}, Earth Observation (EO) \cite{lupi2022socioeconomic, tassa2020socioeconomic}, and Satellite Communication (satcom) \cite{x} has brought us ubiquitous connectivity in every corner of this world, while unlocking previously unimaginable capabilities in position, navigation, and timing (PNT), as well as intelligence, surveillance, and reconnaissance (ISR).
Recently, the satellite communications industry has entered into an era of rapid change.
Since the early 2010s, the most prominent new trend has been the large megaconstellations of hundreds to thousands of satellites in Low Earth Orbit (LEO).
These have been enabled by the falling cost of space launches and mass-production of satellite hardware based on Commercial Off-The-Shelf (COTS) technology.

Aside from commercial markets, governmental organisations such as civilian public safety authorities and defense ministries have expressed great interest in emerging commercial satellite communication solutions.
In terms of user segments, governmental organisations tend to pay greater attention to the security and resilience aspects of the communications solutions they utilise, which has in turn raised questions regarding the conformity of these systems.

Protecting these commercial satellite systems against a growing number of increasingly cyber-capable adversaries has become a prerequisite for adopting new satellite systems by governmental agencies.
Here, robust understanding of the evolving threat landscape is a key starting point for design of effective cybersecurity measures.
Recently, LEO broadband systems have been increasingly used by commercial and government actors for satellite system security.

Despite their decades-long development history, current satellite systems still lack widely accepted cybersecurity standards \cite{lin2022defending}.
Varying technical solutions and their proprietary nature has raised a set of potential vulnerabilities.
Moreover, the wide-area broadcast nature of satellite transmissions renders them vulnerable to adversarial groups from abroad or even across an entire continent.
This was demonstrated in \cite{pavur2020tale} where the feasibility of eavesdropping downlink satellite traffic was proven practically using widely available and relatively inexpensive satellite television equipment.
Within the field of wireless communication, one key driver for this development have been the proliferation of inexpensive signals processing equipment, such as open source and open hardware Software-Defined Radios (SDR).
These devices have enabled interaction with satellite systems by not only nation states but also even individual enthusiast-level actors.
Moreover, the vulnerabilities in satellite systems are not limited to only the air interface of these commercial systems.
Another third-party vulnerability assessment \cite{santamarta2014wake} uncovered serious design flaws in the implementation of satellite user terminal firmware, such as backdoors, hardcoded credentials, weak encryption algorithms as well as undocumented and insecure protocols.

Recent adversarial actions against satellite systems and their supporting infrastructure have raised questions concerning the vulnerability of these systems to a range of potential attack vectors, including cyberattacks, as well as the physical destruction of individual satellites or their supporting ground infrastructure.
Recent examples include the cyberattack against the KA-SAT satellite network in February 2022 \cite{boschetti2022space} or the cable cut in one of the optical cables connecting the the SvalSat ground station to mainland Norway \cite{schia2023subsea}.
Similarly, intrusive acts such as the Chinese high-altitude balloons flying through North American airspace in early 2023 have highlighted the threat of aerial signals intelligence platforms \cite{wip}.

One way to understand the reason for these vulnerabilities is through the paradigm of "security through obscurity", a practice with a long-running history in the commercial satellite industry that relies on hiding the structure and the interfaces of the system from the public \cite{lin2022defending}.
The validity of this approach has long been debated within research and industry circles \cite{johansson2008great}, with the recent consensus being that security of a system should never rely exclusively on obscurity \cite{diehl2016law, guo2018defending}.

Although much work has focused on long operational geostationary broadband and non-geostationary narrowband systems, as well as more long term 5G and 6G non-terrestrial networks (NTN), little attention has been directed towards the security of emerging LEO broadband systems.
Moreover, most of the research on satellite system protection has examined downlink communication between the satellite and different earth stations \cite{abdelsalam2023physical}.
Furthermore, more capital-intensive space or airborne platforms have received relatively little attention, with a greater emphasis being placed on the study of ground-based adversaries.
Considering this prior history and recent rapid growth, it is important to better understand the security aspects of this rapidly evolving technology. 

This thesis seeks to assess whether the presence of airborne eavesdroppers poses a risk to the uplink communications of emerging NGSO VSAT networks. in the context of public safety ...
To achieve this goal, quantitative analysis is used by developing a threat model focusing on a Walker-type LEO megaconstellation, fixed Very Small Aperture Terminals (VSAT) and airborne eavesdroppers.
The resilience of LEO broadband systems will be explored using geometric and kinematic analysis, as well as link budgets based on typical hardware configurations.
The developed analytical model will be evaluated numerically by comparing its results against the requirements set by both public safety and defence user groups.

The thesis is structured as follows.
Chapter 2 describes the key characteristics of LEO megaconstellations, the different aerial platforms used for eavesdropping, and signals intelligence.
Chapter 3 develops a threat model comprising passive and active eavesdropping, jamming, as well as signal geolocation.
Chapter 4 examines the scenarios of the model in relation to the requirements set by relevant critical communications user groups.
Chapter 5 discusses the results and compares these against the end-user requirements.
Chapter 6 summarizes this work by discussing the security performance of LEO broadband systems and suggesting directions for future work.

\clearpage

\section{Background}

\subsection{NGSO megaconstellations}
\subsubsection{History and recent developments}
During the last five years the satellite communications industry has entered into an era of change.
The most prominent new trend is the large megaconstellations with hundreds to thousands of satellites in low earth orbit (LEO).
These systems have been enabled by the falling costs in space launches and the mass-production of satellite hardware based on COTS technology \cite{portillo2019technical}.

While unlikely to widely replace terrestrial solutions, satellite systems have the potential to serve as a complimentary coverage and capacity solution for both commercial and public safety users.
These systems could play a part in the ongoing broadband transition of the existing critical communications networks.
Public safety users have more stringent requirements for their communication services when compared to the best effort service provided to normal commercial users.

So far the furthest strides in the new telecom constellations have been made by four companies: SpaceX with its Starlink, OneWeb, Telesat and Amazon with its Project Kuiper.
SpaceX and Amazon are U.S.
companies and Telesat is Canadian, while OneWeb is controlled by its investors from India, the U.K., France and Japan.
In addition to them, multiple other actors from around the world have expressed interest in similar projects.
These include for example the EU‚Äôs Secure Connectivity Initiative and the Chinese Guo Wang constellation.

All four projects furthest in development have significant funding behind their concepts and have secured the necessary regulatory approvals for the initial deployments of their systems.
As of May 2023, OneWeb has finished its first generation constellation of 648 satellites while SpaceX was still rolling out its much larger first generation constellation of 4408 satellites.
Technologically, these constellations are characterised by their employment of dedicated and vendor-specific technologies in their implementation.
For example, all four previously mentioned constellations are currently operating or planning to operate on dedicated Ku and Ka-band frequencies.
Also, their user equipment is vendor-specific in nature, be they more traditional parabolic or modern flat-panel phased array technology-based very small aperture terminals (VSAT).

Two US companies, Lynk and AST SpaceMobile, are also planning on beaming broadband service from orbit directly to smartphone sized handsets on 5G frequencies.
The latter services are less demonstrated and will need significant R\&D investment before becoming a viable option, while the prior are already reaching commercial operability in limited geographic regions.

\subsubsection{Key technical characteristics} \label{ch-constellation-characteristics}
%%%%%%%%%%%%%%%%%% TODO: APPENDIX: COMPARISON TABLE  %%%%%%%%%%%%%%%%%%
The design of a complete satellite system is a complex, multi-objective and multi-modal optimisation problem due to the inherently varying conditions and constraints in the three segments.
Practically speaking, this requires tackling the overall optimisation problem segment-by-segment while taking into account the requirements of the target application.
In , the main elements of a LEO satellite system were characterised into distinct space, ground and user segments, which are visualised in figure \ref{fig-constellation-segments} \cite{celikbilek2022survey}.

Space segment comprises the satellite constellation flying in orbit.
Constellation optimization is typically the primary design problem in LEO-based satellite networks as the parameters, such as orbital altitude, density of satellites, the number and inclination of orbital planes and the phasing between them, affect directly the feasibility of user applications.%and tend to drive the majority of implementation costs.

Ground segment optimisation tends to be more straightforward .
Ground station (GS) planning involves placing a number of stations in appropriate locations around the globe.
Metrics for evaluation range from the achieved sky coverage and system throughput and link capacity to the overall deployment and maintenance costs of the GS network \cite{celikbilek2022survey}.

When considering optimisation, the user segment is the most case-specific of the three.
End user applications range from communication to sensing and navigation with their optimisation criteria often contradicting each other.
Here, \cite{celikbilek2022survey} raises a good example with bandwidth and carrier frequency, where higher numbers are generally desired for example in high-throughput communication applications while the opposite applies to achieving suitable link budgets for example in navigation satellite systems or when users are situated in challenging urban terrain or indoors.

The LEO altitude leads to significantly lower latency and the large number of satellites allows for relatively high overall data throughput when compared with the earlier satellite systems but still significantly lower when compared to terrestrial systems.
While NGSO constellations are nothing new, the emerging operators are promising to offer magnitudes better broadband service when compared to the earlier services offered by e.g.
SES O3b and Iridium while providing the services also at a price point that is competitive with other forms of connectivity [x].

The services are built around vendor-specific user terminals working as WiFi routers that relay the communications on dedicated Ka and Ku-band frequencies to the satellite constellation.

\subsubsection{OneWeb system architecture} \label{ch-oneweb}
% TODO: Beam forming etc. painotusta pit√§√§ s√§√§t√§√§ uuden suunnan mukaiseksi

%%%%%%%%%%%%%%%%%%  FIGURE: ONEWEB NETWORK ARCHITECTURE HERE  %%%%%%%%%%%%%%%%%%
The space segment of the OneWeb system comprises a megaconstellation of 648 LEO satellites distributed into 12 polar orbital planes of 49 evenly spaced satellites, as well as a number of in-orbit spares. 
Operational satellites fly in an inclined polar orbit with an altitude of 1200 km.
Each satellite transmits and receives user terminal (UT) traffic via its 16 fixed Ku-band beams, each of which covers a geographic area with dimensions of 1600 km in longitude and 65 km in latitude.
Gateway traffic is forwarded to the satellite network portals (SNP) via two identical steerable Ka-band spot beams with a significantly more focused circular coverage pattern \cite{henri2020oneweb, worldvu2016loi}.

Earth Stations of the OneWeb system can be broadly divided into three categories: tracking, telemetry and control (TT\&C) sites,  gateways and user terminals (UTs).
In the following, we will focus on the two latter ones, as they are integral to describing the end-to-end configuration of the OneWeb network \cite{worldvu2016loi}.

Going deeper into the gateway-side architecture, the infrastructure can be further split into three components, which are network data centres (NDC), points-of-presence (PoP) and satellite network portals (SNP).
NDCs host the authentication, authorization, policy and UT databases and are deployed in key global locations.
PoPs connect the OneWeb network to the Internet and are deployed at key Internet peering points.
Finally, SNPs maintain the connectivity to the LEO space segment composed of the OneWeb satellite constellation.
They are situated in remote locations around the globe with room for large antenna arrays of 7 to 30 full motion antennas (on average 16) equipped with a 3.5 m Ka-band dish \cite{henri2020oneweb}.

On the user terminal side, a similar architectural breakdown can be made ‚Äì the terminal consists of a satellite antenna, receiver and a customer network exchange (CNX) router.
The latter connects the terminal to the end-user devices such as laptops or smartphones \cite{henri2020oneweb}. RF transmissions received by the satellite antenna are demodulated and converted to a digital data stream by the receiver hardware of the terminal.

As OneWeb is a LEO satellite system, UTs need to track the movements of the orbiting satellites in real-time and handover between them as they move in and out of view in order to maintain constant connectivity.
This can be achieved either with traditional steerable dish or more modern phased array antenna designs.
With the prior, two apertures may need to be employed for uninterrupted connectivity, as retrace speed of a single aperture is the inherent limiting factor for hand-over time between satellites.
On the other hand, phased array antennas require only a single aperture as their electronic switching can be considered almost instantaneous \cite{worldvu2016loi}.

Continuing with the distinguishing qualities of the OneWeb system, maybe the most significant is the nature of its air interface coverage pattern, also known as the cell layout.
In the OneWeb satellite RAN, the cells are inherently varying and mobile, while on the contrary they are practically geographically static and pre-defined in a terrestrial network of fixed eNBs.
Consequently, the movement of the UTs (for example equipment mounted on an aircraft or a high-speed train) is relatively slow when compared to the relative velocities of the satellites in orbit.
This means that UT handovers happen mostly due to the orbital movement of the satellites rather than the movement of the UT relative to the surface of the earth, which is the dominating cause of UE handovers in terrestrial systems \cite{corson2019admission}.

In addition to their moving nature, satellite cells are significantly larger in their coverage area when compared to their terrestrial counterparts.
This has multiple consequences for \cite{corson2019admission}

In satellite systems, the link from gateway to UT via satellite is referred to as the forward link while the direction from UT to gateway is referred to as the return link.
It is worth noting that both up- and downlink communications happen simultaneously in both forward and return links.
For example in the return direction, a UT uplinks to and the gateway downlinks from the satellite \cite{kymeta2019link}.
Despite their similarities, capacity of a forward and a return link is not necessarily symmetrical.
In OneWeb's case, forward link is roughly five times the capacity of the return link \cite{worldvu2016loi, portillo2019technical}.

OneWeb satellite system makes use of a bent pipe architecture for both its forward and return links. In the forward direction, each Ku-band user terminal downlink maps onto a predetermined Ka-band gateway uplink and vice-versa in the return direction. \cite{worldvu2016loi, portillo2019technical}

Different transmission schemes are employed depending on the link direction. In the forward direction, transmissions utilise time-division multiplexing on a single 250 MHz wideband carrier. Each user terminal receives the carrier and demodulates it, extracting relevant payload information based on the headers. \cite{worldvu2016loi}

a modified LTE waveform capable
of adaptive modulation and coding \cite{allen2022terrestrial}

In the return direction, transmissions utilise a single-carrier time and frequency division multiple access (SC-TDMA/FDMA) scheme. Return direction user terminal to satellite links transmit data in time bursts on a relatively narrow carrier that varies between 1.25 MHz and 20 MHz in bandwidth. Multiple user terminals are able to access a single uplink carrier based on time slots allocated by the network control centre. Terminals are also able to access multiple uplink carriers based on the FDMA channel arrangement of the satellite in question. \cite{worldvu2016loi}

Generally speaking, Ka-band gateway-to-satellite links are asymmetric in nature. In terms of their channel configuration, the links employ 16 up and downlink channels, bandwidth of individual channels being 155 MHz in the uplink and 250 MHz in the downlink direction. The links alternate between right and left-hand polarised (RHCP / LHCP) signals. \cite{portillo2019technical}

Similar to the gateway links, the Ku-band satellite-to-user terminal links are asymmetric in nature, but at the same time they are more limited in terms of the available bandwidth. The four uplink channels occupy 125 MHz of bandwidth while there are eight 250 MHz downlink channels. Unlike the gateway links, the polarisation scheme of the signals is fixed based on the link direction, where uplink utilises RHCP and downlink LHCP. \cite{portillo2019technical}

\subsubsection{Starlink system architecture}

SpaceX's Starlink constellation is a combination of an inclined Walker Delta and a polar Walker Star configuration. The system consists of 4,408 satellites divided into five orbital shells at altitudes ranging between 540 and 570 km. Inclination-wise, a large majority of the fleet is situated in 70 to 72 degree orbits covering the higher populated latitudes, while a reduced set in 97.6 degree orbits covering the remaining polar regions. Table \ref{table-starlink-orbits} presents the distribution of the satellites to the orbital shells and planes in more detail \cite{spacex2020mod, pachler2021updated}.

\begin{table}[h]
  \centering
  \caption{Orbital shells and planes of the Starlink constellation \cite{spacex2020mod}.}
  \begin{tabular}{@{}lllll@{}}
  \toprule

  Altitude (km) &
  Inclination (deg) &
  Planes &
  \begin{tabular}[c]{@{}l@{}}Satellites\\ per plane\end{tabular} &
  \begin{tabular}[c]{@{}l@{}}Total\\ satellites\end{tabular} \\ \midrule

  540 & 53.2 & 72 & 22 & 1584 \\
  550 & 53.0 & 72 & 22 & 1584 \\
  560 & 97.6 & 6  & 58 & 348  \\
  560 & 97.6 & 4  & 43 & 172  \\
  570 & 70.0 & 36 & 20 & 720  \\ \bottomrule
  \end{tabular}
  \label{table-starlink-orbits}
\end{table}

\begin{figure}[h]
  \centering
  \input{tikz_figures/fig-oneweb-starlink-f-plan.tikz}
  \caption{Frequency plan.}
  \label{fig-f-plan}
\end{figure}

Starlink satellites communicate with UTs through Ku-band links.
From the space segment, traffic is either relayed to other satellites via optical inter-satellite links (ISL) or to gateways on higher frequency Ka-band links.
Satellites have four phased array antennas, three of which function as downlink and one as uplink.
All four arrays are // capable of projecting eight // independently shapeable and steerable spot beams, resulting in a 3-to-1 downlink-to-uplink ratio.
Figure X presents Starlink and OneWeb frequency plans in relation to each other \cite{spacex2016loa}.

Beam radiation pattern is dependent mainly on the steering angle of the beam with angles farther from boresight making the beam footprint more elliptical.
Starlink 3 dB beam footprints vary between x and x kilometers in their major axis.
Minor axis varies less with values ranging between x and x kilometers depending on the beam steering angle.
Overall beamwidth is controlled by selectively switching on additional array elements as the steering angle rises.
Minimum elevation angle of the SpaceX system is 25 degrees \cite{spacex2016loa, spacex2020mod}.

Ground segment 1.5 m Ka-band antennas

Starlink dish variants. Common feature ESA technology. Some flat panel while others use steering. Size varies between x and x m.

Starlink's cell pattern is based on Uber's H3 hexagonal cell system. Each spot beam covers roughly 1 size 5 hex cell at nadir. It is worth noting that the beam becomes more elliptical at higher steering angles, thus covering more cells at the same time.

\subsection{Aerial platforms} \label{sect-aerial-platforms}

\subsubsection{Classification schemes}

Aerial platforms come in many shapes and sizes with widely varying capabilities.
Based on these, the systems can be categorised in a number of ways depending on the end goal of the classification effort.
For example, aviation regulation can be thought to form a comprehensive risk-based classification framework for the whole spectrum of platforms all the way from small drones and lighter-than-air balloons to heavy manned jet aircraft.
On the other hand, these regulatory classifications tend to be very coarse in their breakdown to avoid ambiguity, limiting their applicability for evaluating platforms based on their capabilities rather than their inherent risks.

This is something that can be see for example in the drone regulation of the European Union Aviation Safety Agency (EASA).
The framework in the 2020 regulation splits UAS into three distinct operational categories, which are open, specific and certified.
The risk model considers four core factors in its evaluation: maximum takeoff mass (MTOM) of the UAS, whether the payload is hazardous, whether the vehicle is flown in visual line-of-sight (VLOS) of the operator and at what altitude \cite{alamouri2021exploratory}.

Risk-based approaches tend to be primarily mass-driven. In order to gain a more holistic picture of the platform under evaluation, we may want to introduce some additional factors into the classification.
While there are an almost endless list of potential variables to classify a complex system, the top-level categories of performance, payload, system configuration tend to encompass a majority of the ones relevant for different aerial platforms, be they a heavier manned aircraft, lighter-than-air craft or fixed or rotary wing UAV.
Figure \ref{fig-3d-dhs-uas-classification} visualises the classification originally devised by the U.S.
Department of Homeland Security in terms of operational altitude and endurance.

\begin{figure}[h]
  \centering
  \input{tikz_figures/fig-3d-dhs-uas-classification.tikz}
  \caption{UAS classification in terms of operational altitude $h$ (kilometers) and endurance $t$ (hours) \cite{watts2012unmanned}.}
  \label{fig-3d-dhs-uas-classification}
\end{figure}

In \cite{watts2012unmanned}, the authors looked at classifying variety of unmanned aerial systems (UAS) platforms and sensor payloads based on their capabilities and applicability for meeting the demands of users in the scientific research sector.
The authors adopted a UAS classification framework that draws heavily from earlier military categorizations used by the security establishment in the United States.
The framework divides UAS platforms into seven categories based upon characteristics such as size, flight endurance, and capabilities.
The categories are in ascending order by mass and performance micro air vehicles (MAV), vertical takeoff or landing craft (VTOL), low altitude short endurance UAS (LASE), close proximity LASE UAS (LASE Close), as well as low, medium and high altitude long endurance UAS (LALE, MALE and HALE).
Figure \ref{fig-3d-dhs-uas-classification} presents the prior categories in terms of MTOM and operational altitude with LASE and LASE Close combined into a single category.

\begin{table}[tb]
  \centering
  \caption{UAS classification groups of the U.S. DoD.}
  \begin{tabular}{@{}lllll@{}}
  \toprule
  \begin{tabular}[c]{@{}l@{}}UAS\\ category\end{tabular} &
    \begin{tabular}[c]{@{}l@{}}Maximum\\ Gross Takeoff\\ Weight (kg)\end{tabular} &
    \begin{tabular}[c]{@{}l@{}}Normal\\ Operating\\ Altitude (m)\end{tabular} &
    \begin{tabular}[c]{@{}l@{}}Speed\\ (IAS, km/h)\end{tabular} &
    \begin{tabular}[c]{@{}l@{}}Representative\\ UAS\end{tabular} \\ \midrule
  Group 1 &
    0 -- 9 kg &
    \textless 370 AGL &
    190 &
    \begin{tabular}[c]{@{}l@{}}WASP III,\\ TACMAV RQ-14A/B\\ Buster,\\ Nighthawk,\\ RQ-11B,\\ FPASS,\\ RQ-16A,\\ Pointer,\\ Aqua/Terra Puma\end{tabular} \\ \addlinespace[0.5em]
  Group 2 &
    9 -- 25 kg &
    \textless 1000 AGL &
    \textless 460 &
    \begin{tabular}[c]{@{}l@{}}ScanEagle,\\ Silver Fox,\\ Aerosonde\end{tabular} \\ \addlinespace[0.5em]
  Group 3 &
    \textless 600 kg &
    \textless 5500 MSL &
    \textless 460 &
    \begin{tabular}[c]{@{}l@{}}RQ-7B Shadow,\\ RQ-15 Neptune,\\ XPV-1 Tern,\\ XPV-2 Mako\end{tabular} \\ \addlinespace[0.5em]
  Group 4 &
    \textgreater 600 kg &
    \textless 5500 MSL &
    Any airspeed &
    \begin{tabular}[c]{@{}l@{}}MQ-5B Hunter,\\ MQ-8B Fire Scout,\\ MQ-1C Grey Eagle,\\ MQ-1A/B/C Predator\end{tabular} \\ \addlinespace[0.5em]
  Group 5 &
    \textgreater 600 kg &
    \textgreater 5500 MSL &
    Any airspeed &
    \begin{tabular}[c]{@{}l@{}}MQ-9 Reaper,\\ RQ-4 Global Hawk,\\ RQ-4N Triton\end{tabular} \\ \bottomrule
  \end{tabular}
  \label{table-dod-uas-groups}
\end{table}

It is worth noting, that the U.S. Department of Defence (DoD) switched to a joint classification scheme for UAS in early 2010s.
As described in \cite{jp3-30}, the classification encompasses all platforms that the different branches had in use when the scheme was introduced.
The DoD scheme categorises UAS into five groups based on the MTOM, operational altitude and speed of the platform.
Table \ref{table-dod-uas-groups} presents the DoD UAS groups as they are defined in \cite{jp3-30}.
The imperial units of the original classification have been converted to metric and rounded for the sake of readability.

In \cite{hassanalian2017classifications}, the authors propose a more fine grained classification. 
While the classification is very detailed in terms of different structural sub-types, the basic approach is still similar to previous classification models following a mass-and-size-based approach.
On the highest level, their classification breaks UAS into six categories: normal and small UAVs, and micro-, nano- and pico air vehicles (MAV, NAV and PAV).
The mass-and-size top-level classification is complemented by a more fine grained structural configuration based classification. Figure \ref{fig-hassanalian-uas-classification} presents the UAV classification in more detail.
Third-level categories of rotary wing and Bio NAV / MAV types have been omitted from the figure.

\begin{figure}[h]
  \centering
  \input{tikz_figures/fig-hassanalian-uas-classification.tikz}
  \caption{A classification scheme per \cite{hassanalian2017classifications}.}
  \label{fig-hassanalian-uas-classification}
\end{figure}

% P√§√§paino on k√§yt√§nn√∂ss√§ massa- ja kokopohjaisessa arvioinnissa

% TODO: Vertailutaulukko (ehk√§ liitteeseen?)

% Expanding the classification to the full range of platforms

\subsection{Signals intelligence}
Signals intelligence (SIGINT) is intelligence gathering through the exploitation of communication systems and noncommunications emitters.
Based on the nature of the target system, the discipline of SIGINT can be further subdivided into the sub-disciplines of communications intelligence (COMINT) and electronic intelligence (ELINT) \cite{national2015bulk} [JP 1-02, JP 2-0 (2013), JP 3-85].

Considering satellite communication systems, the two disciplines of signals intelligence provide a wide range of tools for intelligence gathering at different levels of abstraction.
On the most resource-intense end, we have the interception and extraction of user traffic, the defined scope of COMINT.
However, less sophisticated methods, such as signal detection and fingerprinting, direction finding (DF) and radiopositiong may still yield valuable insights into the nature of the utilized systems, the user organisations, use patterns.
As no 

Interception of user traffic in satellite networks falls under the discipline COMINT. On  based on methods such as time of 

% TODO
EOB (WIP / J03-85)

Electromagnetic support (ES) and SIGINT.
ES is closely related to, but separate from, SIGINT.
The distinction between an asset performing an ES mission or an intelligence mission is
determined by who tasks or controls the collection assets, what they are tasked to provide,
and for what purpose they are tasked.
The distinction between ES and SIGINT is
delineated by purpose, scope, and context.
Operational commanders task ES assets to
search for, intercept, identify, and locate or localize sources of intentional or unintentional
radiated EM energy.
In contrast, the Director, National Security Agency (NSA)/Chief,
Central Security Service, or an operational commander delegated SIGINT operational
tasking authority, task SIGINT assets.
The purpose of ES is immediate threat recognition,
support to planning, and conduct of future operations and other tactical actions such as
threat avoidance, targeting, and homing.
ES is intended to respond to an immediate
operational requirement.
ES and SIGINT operations often share the same or similar assets
and resources and may be tasked to simultaneously collect information that meets both
requirements.
That is not to say that data collected for intelligence cannot meet immediate
operational requirements.
Information collected for ES purposes is normally also
processed by the appropriate parts of the intelligence community (IC) for further
exploitation after the operational commander‚Äôs ES requirements are met.
As such, it can
be said that information collected from the EMS has ‚Äútwo lives.‚Äù The first is as ES,
unprocessed information used by operational forces to develop and maintain SA for an
operationally defined period of time.
The second is as SIGINT, retained and processed
under appropriate intelligence authorities in response to specified intelligence
requirements.

\subsubsection{Signal detection}
\subsubsection{Direction finding and radiopositioning}
Geolocating fixed VSAT terminals implemented as phased arrays, different direction finding techniques can be assessed for their suitability based on several factors.
Some of the modern techniques include:

Angle of Arrival (AoA): AoA techniques can be suitable for geolocating VSAT terminals.
By measuring the angles from which the signals arrive at the aircraft's direction finding array, the azimuth and elevation of the terminals can be estimated.
AoA techniques like beamforming, MUSIC, or ESPRIT can be effective in estimating the angles of arrival, especially if the phased array terminals have discernible sidelobes or beam characteristics.

Time Difference of Arrival (TDOA): TDOA relies on measuring the time delays between signals received at multiple spatially separated sensors.

Frequency Difference of Arrival (FDOA): FDOA relies on measuring the frequency differences of signals arriving at different sensors or antennas.
FDOA techniques may provide useful information if the signals have specific frequency characteristics or modulation patterns that can be exploited.

Beamforming: Since phased array VSATs employ beamforming, the listeners direction finding array can analyze the received signals' phase and amplitude information to estimate the direction of arrival.

Additionally, multiple techinques can be combined into a hybrid approach if the complexity and capabilities of the direction finding array permit.
For example, combining AoA and beamforming techniques can enhance the accuracy and robustness of geolocation estimates, especially if the phased array terminals exhibit unique radiation patterns or have challenging sidelobe characteristics.

\subsubsection{Eavesdropping and traffic analysis}
Fundamentally, secure communications rely on two core objectives being fulfilled.
The intended receiver should be able to recover the original message without errors, while nobody else should be able to acquire any of the contained information.
As is customary in cryptography, the transmitter is often referred to as Alice, the receiver as Bob and the eavesdropper as Eve.
\cite{bloch2011physical}

This core principle of secure communications was formalised by Shannon \cite{shannon1949communication} in his 1949 paper through the notion of perfect secrecy achieved through a one-time pad.
Shannon's secrecy system assumes that both the intended recipient and the eavesdropper acquire the encoded codeword without any degradation, i.e.
the communication channel is error-free.
This theoretical assumption applies very rarely to real world systems, where some noise is almost always present.
\cite{bloch2011physical}

Wyner \cite{wyner1975thewiretap} expanded on Shannon's original system by exploring the role of noise in the context of secure communications through the channel model called \textit{degraded wiretap channel} (DWTC).
The model assumes a situation where the sender (Alice) attempts to communicate with the legitimate recipient (Bob) over a noisy channel.
Simultaneously an eavesdropper (Eve) observes a degraded version of the signal received by the legitimate recipient.
\cite{barros2006secrecy}

Wyner's wiretap channel introduced many mathematical tools for modelling information-theoretic security without the added complexity of fully general channel models.
One of these important concepts is the secrecy capacity of the channel, which describes the greatest amount of information that can be confidentially communicated between the legitimate transmitter and receiver from the information-theoretic secrecy perspective.
\cite{bloch2011physical}

Csisz√°r and K√∂rner \cite{csiszar1978broadcast} developed a more general approach that they termed the \textit{broadcast model with confidential messages}.

\clearpage

\subsection{Critical communications}
\subsubsection{Narrowband-to-broadband evolution}
Starting in the mid-2020s, critical communications are entering a major paradigm shift. Thus far, national authorities have relied globally on dedicated, purpose-built narrowband technologies such as TETRA, Tetrapol and P25 in their operational communications. Broadband standardisation initiated by The Critical Communications Association (TCCA) Critical Communications Broadband Group (CCBG) in 2012 and developed in a working group of 3GPP‚Äôs Technical Specification Group since 2015 have adapted the commercial 4G/5G standards to the strict requirements of critical communications. Roll-out of systems built around these standards is currently ongoing in many countries, for example through migration projects such as VIRVE2 in Finland, RRF in France or ESN in the United Kingdom.

The evolution is not limited to just wireless communication technology. In the public safety context, the shift to the more versatile broadband ecosystem enables transitioning from the current voice-only operating model to a more diverse one with voice, video and data capabilities. The higher versatility necessitates reliable access to magnitudes greater bandwidth for them to function. In narrowband networks, building coverage was often the main factor to be considered. On the other hand, ensuring adequate capacity alongside coverage requires additional consideration in broadband networks \cite{saynevirta2021satellite}.

The broadband transition also means a shift from custom technology solutions to more mainstream ones. Critical communications segment places strict requirements on availability, reliability, security, and coverage. For example, the coverage requirement for a national critical communications network can be close to 100 percent of the geographic coverage, while commercial networks are built based on a business case primarily driven by population density. In general, this leads to coverage figures far from 100 percent \cite{saynevirta2021satellite}.

\subsubsection{Use cases and scenarios}
Critical communications service operators see satellite systems as a complementary coverage and capacity solution, where the main use cases can be characterised through how long lasting and planned the events requiring response are.
On a high level, the coverage and capacity needs can be either permanent, planned temporary or unplanned temporary in nature.
Prevalent geographic conditions and duration of active use tend to be the determining factors that decide which of the cases is the most applicable in each situation.

Permanent applications tend to be the most obivious when it comes to the typical locations. They encompass the traditionally difficult-to-serve regions.
For example, sparcely populated rural areas and maritime settings have been typically rather poorly served by mobile network operators due to their limited commercial potential.
On the other hand, the temporary use cases tend to be more varied in terms of the potential types of locations. While coverage augmentation is typically still needed only in underserved locations, capacity needs may arise in areas with normally sufficient terrestrial coverage.
For example, large events are a typical example of temporary use cases that can be planned for in advance. These include mass events like sports and concerts and political events like state visits and summits \cite{erve2018trump, tcca2021airbus, airbus2023bahrain}.
Unplanned events can be both man-made or acts of nature and can range from localised to widespread in affected area. For example, natural disasters, like earthquakes, floods, or forest fires, can lead to widespread infrastructure damage, while man-made disasters like airplane crashes or multiple vehicle collisions are usually more limited in terms of the affected area \cite{firstnet2021wildfire, firstnet2021nashville}.

Another differenciating factor of the above mentioned events is their forecastability and typical duration. Both planned and unplanned events can last from days to months, with the duration having different implications for the choice of the best suited technological solution. Satellite connectivity may even be needed permanently when it comes to backhaul applications in very remote locations to where building terrestrial connectivity might be simply unfeasible.
The cut to planned and unplanned events is also not really black-and-white, but these notions exist on a spectrum of different tones of grey. For example, natural disasters such as earthquakes might cause unplanned damage that requires immediate response. On the other hand, some weather events, such as hurricanes and forest fires may be forecasted to differing extents.

All in all, satellite connectivity does not replace the traditional terrestrial networks but complements them. If deployed to their envisioned state, broadband satellite systems may work as a cost-efficient way to serve these regions and events. Thanks to their truly global coverage pattern, while the lower user density in these regions is still within the load carrying capacity of these networks.

\subsubsection{Requirements}

\textbf{Security}

Public Safety users have stringent data security requirements for their communications due to the sensitive nature of these exchanges. Satellite links bring new considerations in the transit of the data through other nations, as the networks are inherently global in nature. In the commercial operating model the constellations downlink data at sites that are most convenient for their operation, which means that the data will often transit through other sovereign countries before arriving at its final destination. Over-the-air transmission of data presents also questions on the jamming resilience of the satellite links.

This poses challenges during situations where a nation is under an external threat, be it a military conflict or an act of a rogue organisation, as sensitive operational information needs to remain only in the hands of its intended users. In addition to these general architectural considerations, the technical solutions themselves should be verifiable on the national or at least at the EU level for both the hardware and software.

\textbf{Resilience and preparedness}

Preparedness is a key aspect in the operating model of public safety organisations. It covers the actions required for ensuring the smooth execution of tasks central to the overall safety of a nation in large emergency situations and societal disruptions. Preparedness actions include contingency planning, continuity management, advance preparations, training of operatives and readiness exercises. The concept revolves around the goal of anticipating threats rather than having to react to them [12].

In the case of public safety communications, this leads to high requirements for availability even in a state of emergency. Similarly to more traditional terrestrial solutions, the requirements apply also to the emerging satellite links, which will most likely serve as a back-up solution in the case of larger scale failures of other options.

\textbf{Control of the constellation}

Satellite links are likely the best suited to natural disasters and major accidents but open questions remain related to human-made threat situations, like terrorist attacks and military conflicts, where external actors may deliberately interfere with the communications links. This raises questions on the political regimes where these current and future constellations are owned and operated. Nationally controlled satellite communications solutions would be the most optimal but are unfeasible for most of the World‚Äôs nations to implement. This is due to the immense capital requirements, especially when considering LEO options, which require at minimum hundreds and often thousands of satellites.

These budgetary requirements lead to a situation where most nations need to rely on satellite services that are provided by operators from foreign countries. As discussed later, many of the emerging new operators are either US or UK based, while the EU has also been considering entering the constellation sector with its own alternative. In the EU member state context the latter is probably the most attractive option, especially from the point of critical communications. Control over the constellation and its ground segment will be as close to the national level as is feasible with the capital intensive satellite systems. US and UK based solutions might be also in this sense allowable but are likely to require significant legislative work when used by governmental public safety users.

\textbf{Usability}

Straightforward usability of the systems is highly critical from the perspective of public safety users based on the interviews with Finnish Public Safety actors. The success rate in emergency situations depends heavily on the timeliness of the response, which means that the communication systems used in field activities need to be available on a standby-basis. Thus, the future satellite link would need to be highly integrated with the existing communications infrastructure for it to be effective, so that it can be used when necessary.

Considering these usability requirements, an ideal user terminal would be a handset with integrated satellite communication capabilities, but this is not feasible with the current satellite terminal sizes. The more feasible alternative in the near-term would be the integration of the terminal to the vehicles used by the authorities in daily activities.

In addition to conveniently sized and well integrated user terminals, satellite services should be agnostic to the applications that are run through the link they provide. Currently used applications include PTT, data and video, while in future the systems should be able to accommodate more complex applications, like the verified positioning services provided by the Galileo Public Regulated Service (PRS). This may though require special arrangements in timing critical applications, as satellite systems have longer end-to-end delay times compared to terrestrial systems.

\textbf{Costs}

Cost considerations are another important point of discussion as they have been a limiting factor for the adoption of the existing satellite services. The new constellations need to achieve significantly lower per user costs for the solutions to gain widespread adoption. The public safety sector is a niche market from the point of view of the constellation operators, which is especially the case for smaller countries like Finland. Volume based pricing models are a possible way of achieving cost advantages but are likely to require the tendering processes to include multiple possible user groups. One straightforward model for providing satellite access to the user organisations could be to include it to the services provided by a national critical communications operator (e.g. Erillisverkot in Finland).

For the solutions to become widely used, their monthly cost should be tens of euros for an individual user terminal. If implemented as a vehicular solution, these kinds of monthly costs would lead to a country wide cost in millions of euros.

\subsubsection{Technical considerations}

Implementation-wise, permanent use cases are maybe the most straight forward, as they are can be implemented as a simple FSS backhaul link of an individual base station site. Direct satellite connectivity is also something that may be feasible in these regions long-term, but as was discussed in chapter \ref{ch-constellation-characteristics}, its technological maturity remains relatively low. 

Implementation-wise, satellite networks are in the short-to-medium term envisioned to integrate into the terrestrial networks through portable tactical bubbles, where the satellite link serves as a backhaul solution for a local (?100 meters to kilometers?) wireless connectivity bubble. In practice, current equipment form factor and cost supports best a vehicular deployment model. For example the French RRF envisions satellite networks as one backhaul option for its vehicular relay (\textit{relais v√©hiculaire}), an emergency vehicle with a tactical bubble for local coverage and capacity. On the other hand, integration point for satellite systems in the Finnish VIRVE2 has been envisioned as command vehicles of fire, rescue and police forces \cite{RRF_VIITE,saynevirta2021satellite}.

Long-term, evolution towards direct-to-smartphone type solutions is a potential development path. 3GPP has been working towards integrating satellite connectivity as one of the options in the 5G Non-terrestial networks (NTN), a development item also present on the longer-reaching 6G roadmaps \cite{6G_ROADMAP, 3GPP_NTN_PAPERS}. It is though worth noting, that these solutions remain rather low in terms of their technological maturity. In-orbit demonstrations of the technology have been very limited in number and work has focused more on the theoretical standardisation work %TODO: \cite{AST_TESTIT, LYNK_TESTIT, SPACEX_TESTIT, PAPEREITA}

Heikkil√§n taulukko

\begin{table}[]
  \centering
  \caption{Essential requirements for tactical bubbles.}
  \begin{tabular}{@{}lll@{}}
  \toprule
  Communication type            & Requirement category  & Identified requirements \\ \midrule
  Generic                       & Availability          & 99\% to 99.999\%        \\
                                & Start-up time         & 0 to few minutes        \\
                                & Configuration efforts & Zero-configuration      \\
  Combined user traffic (avg.)  & Downlink / user       & 50 Mbps                 \\
                                & Uplink / user         & 25 Mbps                 \\
  Push to talk                  & Packet delay          & 75 ms                   \\
  Group video                   & Packet delay          & 100 ms                  \\
  Virtual reality (4K GC video) & Data rate             & 50 to 200 Mbps          \\
                                & Latency               & \textless 16 ms         \\
  Sensor data                   & Sensor amount / cell  & 0 to massive            \\
  Machine remote control (UAV)  & Latency               & 40 ms to 1 s            \\ \bottomrule
  \end{tabular}
  \label{table-mcx-requirements}
\end{table}

Yaralin kirja

6.3.1 Network Requirements

Current drives to bring about the benefits of commercial broadband networks to mission-critical service providers have developed solutions ‚Äúover-the-top‚Äù of existing public networks.
Doing so is, however, not sustainable in the long-term since the public safety networks desire a level of sophistication that ensures they get priority in the systems (Tata and Kadoch 2014, p.
3).
The networks should be managed in the same way that TETRA, TETRAPOL, and P25 works, giving priority bandwidths to public safety networks while ensuring that the communication is encrypted end to end.
Even in extreme weather conditions, the dedicated broadband services for the mission-critical services must ensure:

    Survival over multiple failures
    Priority for mission‚Äêcritical data
    Offer the desired coverage and capacity
    Maintain data integrity and ensure end‚Äêto‚Äêend encryption
    Be interoperable with other networks to offer solutions when needed
    Provide the desired support for devices and applications.




In this section, we address the important security features of the TETRA network.
Here the scope of coverage spans the authentication, encryption mechanisms, and the key management of TETRA.
It dictates that a secure communication network needs to provide (Stavroulakis, 2007):

    Confidentiality
    Integrity
    Reliability
    Non‚Äêrepudiation
    Authentication.

6.7.8.1 Confidentiality

    Only authorized personnel or people should have access to the information being passed along.

6.7.8.2 Integrity

    This refers to the requirement that states that only authorized users need to be able to make any modifications to the information in exchange.

6.7.8.3 Reliability

    This refers to the requirement that the resources and the services are not denied and are available to the authorized users to accomplish various tasks.

6.7.8.4 Non‚Äêrepudiation

This requires that the sender cannot deny that he/she sent the message.
6.7.8.5 Authentication

    This refers to the requirement that the sender's identity is verifiable by the recipient.

\clearpage

\section{Research material and methods}

%\subsection{Analysis toolchain}
%\subsubsection{Modelling of the HAPS}
%\subsubsection{Modelling of the satellite constellation}
%\subsubsection{Channel model}

\subsection{Methodology}

There are a multitude of potential ways to classify research methods. J√§rvinen \cite{jarvinen2011tutkimustyon, jarvinen2004research} proposes a taxonomy of six research approaches, a framework expanding on previous work by March and Smith \cite{march}.
The taxonomy is presented in figure \ref{fig-research-taxonomy}.
Within the taxonomy, this thesis falls under the conceptual-analytical research approach, the scope being technology-oriented in nature.
In practical terms, the research is grounded in a modelling approach described in an electronic warfare handbook by the Finnish Defence Forces \cite{kosola2004elektroninen}.
The developed model also incorporates relevant elements from theory of satellite systems, such as orbital mechanics.

% TODO: Methodology mit√§ tarkoittaa, tunnusmerkist√∂
% TODO: Miten ty√∂ toteuttaa t√§t√§ l√§hestymistapaa?

% Datal√§hteet

\begin{figure}[h]
  \centering
  \input{tikz_figures/fig-research-taxonomy.tikz}
  \caption{Research approach taxonomy of J√§rvinen \cite{jarvinen2011tutkimustyon, jarvinen2004research}. Conceptual-analytical approach followed in this thesis is highlighted.}
  \label{fig-research-taxonomy}
\end{figure}

Parametric study of an analytical model.

\clearpage

\section{Results}

\subsection{Threat model}
The core goal of this thesis is to assess whether the presence of airborne eavesdroppers poses a risk to the uplink communications of emerging NGSO VSAT networks.
The research applies quantitative analysis by building a threat model focusing on a Walker-type LEO megaconstellation, fixed Very Small Aperture Terminals (VSAT) and airborne eavesdroppers.
The threat model is built around a set of four smaller submodels, each examining analytically a relevant dependent variable against a number of independent ones.
The models are first introduced in a deductive manner tying reality to the underlying theoretical concepts.
Individual submodels are then parametrically studied in a range of starting conditions mirroring the relevant characteristics of the platforms under evaluation.
Descriptions for the submodels are given in table \ref{table-sub-model-descriptions} while their independent and dependent variables are introduced in table \ref{table-sub-model-variables}. Generally speaking, the target system will be explored using geometric and kinematic analysis, as well as link budgets based on typical hardware configurations.
We will asses the problem following a first principles method. % tarkastelu tapahtuu fundamentaaleista dimensioista l√§htien, ensimm√§isen ja nelj√§nen alamallin pureutuessa avaruudelliseen ulottuvuuteen ongelmiien ja toisen ja kolmannen tarkastellessa aika-ulottuvuuden ilmi√∂it√§.

%% TODO: Miksi relevantteja tutkittavia asioita?

%% TODO: Miten liittyy public safety caseen?

%% TODO: Mist√§ ne on tullut? Mik√§ niitten suhde?

%% TODO: Osamallin tarkoitus? Oma taulukko muuttujille?

% use \addlinespace[0.5em] to add space between the rows

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[h]
  \centering
  \caption{Descriptions for the sub-models.}
  \begin{tabular}{@{}cl@{}}
  \toprule
  \multicolumn{1}{l}{sub-model} & target metric              \\ \midrule
  1                             & maximum interception range \\
  2                             & beam tracking potential    \\
  3                             & listening window           \\
  4                             & jamming link budget        \\ \bottomrule
  \end{tabular}
  \label{table-sub-model-descriptions}
\end{table}

Submodel 1 examines the maximum interception range of a fixed satellite terminal.
This metric helps us to evaluate the potential maximal area where a single satellite terminal is vulnerable to airborne eavesdroppers.

\begin{table}[h]
  \centering
  \caption{Independent and dependent variables of the sub-models.}
  \begin{tabular}{@{}cll@{}}
  \toprule
  Sub-model &
    Dependent variable &
    Independent variables \\ \midrule
  1 &
    interception range (m) &
    \begin{tabular}[c]{@{}l@{}}minimum elevation angle (deg)\\ eavesdropper‚Äôs altitude (m)\end{tabular} \\ \addlinespace[0.5em]
  2 &
    \begin{tabular}[c]{@{}l@{}}velocity of the sub-satellite point,\\ equatorial (m/s)\end{tabular} &
    orbital altitude (m) \\ \addlinespace[0.5em]
  2 &
    \begin{tabular}[c]{@{}l@{}}velocity of the sub-satellite point,\\ inclined (m/s)\end{tabular} &
    \begin{tabular}[c]{@{}l@{}}orbital altitude (m)\\ inclination (deg)\end{tabular} \\ \addlinespace[0.5em]
  3 &
    listening window (s) &
    \begin{tabular}[c]{@{}l@{}}orbital altitude (m)\\ inclination (deg)\\ eavesdropper‚Äôs velocity (m/s)\end{tabular} \\ \addlinespace[0.5em]
  4 &
    uplink signal power (dB) &
     \\ \bottomrule
  \end{tabular}
  \label{table-sub-model-variables}
\end{table}

\subsection{Submodel 1: Maximum interception range}
% TODO: Scenario description: h√§ritsij√§n sijainti, muuttujat -> orientoiva
In order to eavesdrop a target transmitter, an eavesdropper need to be able to intercept sufficiently strong uplink signal. 
Being firmly out of range of an earth station, in other words inside a white zone, is the most fundamental limit to an eavesdropper's ability to eavesdrop. 
This can be thought as  arise where eavesdropping is either simply impossible or a very tough uphill battle:

\begin{enumerate}
  \item The VSAT earth station falls behind the radio horizon of the eavesdropper.
  \item The eavesdropper falls outside the main lobe of the VSAT earth station.
\end{enumerate}

As discussed in chapter \ref{ch-constellation-data}, broadband VSAT systems operate typically either in the Ku or Ka bands (12--18 and 26.5--40 GHz), with the former being the more commonly used in user links between the orbiting satellite and user terminal and vice-versa.
In terms frequencies, both bands fall under super high (SHF, 3-30 GHz) to extremely high frequencies (EHF, 30-300 GHz), where the principal propagation mode is line-of-sight propagation.
In this mode, the radio horizon of a transmitter can be derived from the Pythagorean theorem, assuming a perfectly spherical planetary body.

Going into the geometry of the problem, line-of-sight distance $d$ and radius of the body $R$ form the legs of a right triangle, while the transmitter's distance from the centre of the body $(R+h)$ is the hypotenuse \cite{seybold2005introduction}.
The relationship between the quantities is visualised in figure \ref{fig-interception-range-vacuum}.

% TODO: SELIT√Ñ MIKSI VOIDAAN APROKSIMOIDA TOISESSA VIRKKEESS√Ñ

\begin{equation*}
  d^2=(R+h)^{2}-R^2= 2R \cdot h + h^2 \\
\end{equation*}

In case of the Earth, the height of both surface-bound and airborne transmitters $h$ is rather insignificant compared to the radius of the body $R$. Thus, we can simplify the line-of-sight equation to

\begin{equation} \label{eq-radio-horizon-vac}
  d \approx \sqrt{2R \cdot h}
\end{equation}

It is worth noting that equation (\ref{eq-radio-horizon-vac}) applies only in vacuum.
Vertical pressure variation of an athmosphere refracts passing electromagnetic waves. In practice, the waves deviate from a straight line down towards the surface. This deviation can be accounted for by applying a factor $k$ to equation (\ref{eq-radio-horizon-vac}). In case of the Earth, an effective radius of $4/3$ is usually applied \cite{seybold2005introduction}.

\begin{equation} \label{eq-radio-horizon-ath}
  d \approx \sqrt{2 k \cdot R \cdot h}
\end{equation}

Radio horizon allows us to examine situations where the transmitting antenna is either isotropic or pointed deliberately in the direction of the horizon.
This is not always the case with highly directional VSAT terminals, thus requiring additional factors being taken into account.
Here, one of the most important parameters is the minimum elevation angle of the satellite system in question.
Similar to radio horizon, maximum VSAT interception range can be examined through a trigonometric approximation model.

As discussed regarding the characteristics of the terminals, typical minimum elevation angles range from 20 to 55 degrees in the recent broadband megaconstellations in LEO.
As the operational altitude of the eavesdropper is known, theoretical maximum interception range can be computed for a range of the minimum elevation angles.
The measurands form an orthogonal triangle with the minimum elevation as the acute angle opposite to the height of the triangle.
The operational altitude of the eavesdropper is the height of the triangle, while the base is formed by the theoretical interception range of the system.
Lastly, the hypotenuse is the line-of-sight (LOS) distance between the VSAT site and the airborne eavesdropper.

Trigonometric tangent function of the interception range triangle is

\begin{equation} \label{eq-range-1}
  \tan(e_{Alice}) = \frac{h_{Eve}}{d_{Eve}}
\end{equation}

\noindent
where $e_{Alice}$ is the minimum elevation angle of the user terminal, $h_{Eve}$ is the operational altitude of the intercepting airborne platform and $d_{Eve}$ is its distance from Alice on the ground, in essence the interception range.
Rearranging (\ref{eq-range-1}) for $d_{Eve}$ gives

\begin{align} \label{eq-range-2}
  d_{Eve} = \frac{h_{Eve}}{\tan(e_{Alice})}
\end{align}

\begin{figure}[h]
  \centering
  \input{tikz_figures/fig-interception-range.tikz}
  \caption{Interception range ($d$) as a function of minimum elevation angle ($e$) and operational altitude of the eavesdropper ($h$).}
  \label{fig-interception-range}
\end{figure}

%\noindent
Figure \ref{fig-interception-range} shows the interception range $d_{Eve}$ in the range $e_{Alice} = [10^\circ, 85^\circ], h_{Eve} = [100,20000]$.
In the resulting 3D plot, the dependent variable or the interception range ($d_{Eve}$) of the airborne eavesdropper is on the vertical axis.
Independent variables or the minimum elevation angle of the terminal ($e_{Alice}$) and opertional altitude of the airborne eavesdropper ($h_{Eve}$) are on the horizontal axes.

The convex surface exhebits linear growth in relation to altitude $h_{Eve}$ and accelerating tangential growth in relation to $e_{Alice}$.
Therefore, we can deduce that the minimum elevation angle is in most cases the driving factor of the maximum interception range of a VSAT ground station.
The influence of $h_{Eve}$ on $d_{Eve}$ is markedly smaller but still significant, especially when considering terminals with small $e_{Alice}$.
The tangent function has asymptotes at $e_{Alice} = \pi / 2 + n\pi$. Within the given limits, the asymptotes are not reached and the resulting surface is smooth and continuous.

%% TODO: Takaisin reaalimaailmaan alamallin osalta

\subsection{Submodel 2: Beam tracking potential}

\begin{figure}[h]
  \centering
  \input{tikz_figures/fig-orbit-geometry.tikz}
  \caption{Geometry of a circular Earth orbit.}
  \label{fig-orbit-geometry}
\end{figure}

In addition to being aligned along the line-of-sight of the VSAT's main lobe, the eavesdropper needs to be able to intercept sufficiently long transmission to be able to %ilmaista l√§hett√§j√§n olemus. 
This time dimension brings another point to consider when evaluating the risk of eavesdropping.
Different durations of interception have varying implications for the legitimate transmitter.
As an practical example, // millisecond-level? // signal capture might be enough for DF applications, while COMINT would require the eavesdropper to intercept the data stream from minutes to days type of durations.

Maximum duration of signal interception is set by the ability of the airborne platform to track the main lobe of the earth station.
The beam movement is primarily driven by the motion of the receiving satellite in orbit, which is in turn governed by Kepler's laws of orbital motion.
Tracking capability of the aircraft can be evaluated by analysing the velocity of the sub-satellite point at the eavesdropper's operational altitude (point x on figure \ref{fig-orbit-geometry}).
If this velocity exceeds the cruise speed of the eavesdropper, the airborne platform is not able to continuously follow the uplink RF beam, which limits the time window into individual satellite passes.

\subsubsection{Equatorial orbits}

Communication satellites reside often in circular orbits, which are a special case when evaluating Kepler's laws of orbital motion.
Here, the velocity of the sub-satellite point can be computed by solving Kepler's third law for the orbital velocity at a set altitude.
In equatorial orbits, Earth's rotation can be directly substracted from the angular velocity of the satellite, as both share roughly the same rotational axis.

\begin{equation} \label{eq-kepler-3}
  T^2 = (\frac{4\pi^2}{GM})r^3
\end{equation}

where $T$ is the orbital period, $G$ is the gravitational constant, $M$ is the mass of the orbited body and $r$ is the radius of the orbit %measured from the centre of mass of the orbited body.

In essence, the aircraft can be modeled as a low-flying athmospheric satellite.
This allows for the same equations to be used in modeling its kinematic characteristics.
Solving the required velocity for successful beam tracking can be computed by equating the required orbital period of the aircraft to the one of the space-borne satellite.

Orbital period is related to the angular velocity of the satellite $\omega_{sat}$ through the equation

\begin{equation} \label{eq-ang-vel-1}
  \omega_{sat} = \frac{2\pi}{T}
\end{equation}

\noindent
which can be used to solve the tangential velocity component at a set altitude $v_r$

\begin{equation} \label{eq-ang-vel-2}
  v_r = \omega r
\end{equation}

\noindent
As $\omega_{sat} = \omega_{air}$ in the case that the aircraft is able to continuosly track the satellite, the velocity of the sub-satellite point at the cruising altitude of the aircraft $v_{r, air}$ can be solved by combining equations (\ref{eq-kepler-3}), (\ref{eq-ang-vel-1}) and (\ref{eq-ang-vel-2}).
Rearranging Kepler's third law to solve for $v_{r, air}$ gives

\begin{equation} \label{eq-v-air-equatorial}
  v_{r, air} = r_{air} \sqrt{\frac{G M_E}{r_{sat}^3}}
\end{equation}

\noindent
Variables $r_{air}$ and $r_{sat}$ are the orbital radiuses of the eavesdropping aircraft and the receiving satellite measured from the center of the Earth while $M_E$ is the mass of the Earth.
Equation (\ref{eq-v-air-equatorial}) gives $v_{r, air}$ in the ECI coordinate frame.
To compute the actual movement of the sub-satellite point relative to the surface of the Earth, the velocity figure needs to be converted to the ECF coordinate system.
For circular equatorial orbits, this can be simply achieved by substracting the spin of the Earth from $v_{r, air}$.

\begin{equation}
  v_{r, ECF} = v_{r, air} - \omega_E r_{air}
\end{equation}

\noindent
$\omega_E$ is the angular velocity of the Earth at the equator.

\begin{figure}[h]
  \centering
  \input{tikz_figures/fig-subsat-velocity-equatiorial.tikz}
  \caption{Sub-satellite velocity as a function of orbital altitude (m) in equatiorial orbits.}
  \label{fig-subsat-velocity-equatiorial}
\end{figure}

Figure \ref{fig-subsat-velocity-equatiorial} shows the sub-satellite velocity ($v_{r, air}$) of a satellite in equatorial orbit as a function of orbital height $h_{sat} = r_{sat} - R_{E}$, where $R_{E}$ is the radius of the Earth.
Velocities are examined in orbits ranging from LEO to GEO, which corresponds to the range $h_{sat} = [5 \cdot 10^5, 3.7 \cdot 10^7]$.
In the resulting graph, the dependent variable or the sub-satellite velocity ($v_{r, air}$) is on the vertical axis, while the independent variable of the orbital height $h_{sat}$ is on the horizontal axis.
The graph can be observed approaching the rotational velocity of the Earth when $h_{sat}$ approaches the height of GEO 36000 km.
As the graph is computed in the ECF coordinate frame, we can se sub-satellite velocity approaching zero, which means that the satellite appears fixed in its position in the sky.
Cubically decreasing nature of $v_{sat}$ leads to radically higher values for LEO with $v_{sat}$ values ranging roughly between 5 and 7\ km/s in orbital altitudes between $h_{sat} = [5 \cdot 10^5, 2 \cdot 10^6]$.

%% TODO: 2b alaotsikkoon?
\subsubsection{Generalisation to inclined orbits}

Circular equatorial orbits are a good starting point for listening window analysis but their real world applications are somewhat in limited when considering relationship of orbital altitude to coverage and latency.
As discussed in section \ref{sect-orbits} and visualised in table \ref{table-megaconstellation-characteristics}, modern satellite megaconstellations aim to achieve worldwide coverage by placing a number of satellites into inclined circular Earth orbits.
Common configurations include the Walker Star and Delta constellation configurations, the advantages and disadvantages of which are discussed in more detail in the aforementioned chapter.

The same analysis methods remain valid for inclined orbits but some additional factors need to be considered.
Equatorial orbits have only a single velocity component parallel to the xy-plane in both ECI and ECF coordinate frames.
On the other hand, any inclination induces additional velocity component perpendicular to this original equatorial component.
This velocity component is visualised by $v_z$ in figure \ref{fig-inclined-v-components}.

Transitioning from the simple scalar representation into a vector space makes analyzing inclined orbital motion less cumbersome.
Here, angular velocity is a very useful abstraction, as it allows to sum different rotational speed components together.
As angular velocity does not vary in in circular motion, examining the magnitude of the sum of the angular velocity vectors allows us to gauge the tracking potential of differently inclined orbits at the desired range of altitudes.

The ECI coordinate frame is a natural starting point for evaluating orbital motion.
Angular velocity pseudovector of a circular orbit follows the right hand rule, being perpendicular to the rotational plane.
Rotational motion in the equatorial plane can be represented with angular velocity pseudovector $\bm{\vec{\omega}} = [0,0,\omega]^T$.
Inclined orbits can be generated by rotating this equatorial orbit about its diameter, which can be achieved with multiplying the pseudovector with a suitable three-dimensional rotational matrix.
To rotate the orbits about the y-axis of the ECI coordinate frame by $\theta$ degrees, rotation matrix $\bm{R_y}$ can be used.

\begin{equation*}
  \bm{R_y}(\theta) = \begin{bmatrix}
    \cos \theta & -\sin \theta & 0 \\[3pt]
    \sin \theta &  \cos \theta & 0 \\[3pt]
    0           &  0           & 1 \\
    \end{bmatrix}
\end{equation*}

Multiplying the vector by matrix $\bm{R_y}(\theta)$ and substracting the rotation vector of the Earth gives angular velocity vector in the ECF coordinate frame.
This can be in turn be converted to the velocity of the sub-satellite by taking the norm of the angular velocity pseudovector

\begin{equation*}
  \omega_{ECF} =
  ||\bm{R_y}(\theta)\ \bm{\vec{\omega_{sat, i}}} - \bm{\vec{\omega_{E}}}||
\end{equation*}

$\omega_{ECF}$ is the scalar angular velocity of the satellite in the ECF coordinate frame.
$\bm{\vec{\omega_{sat, i}}}$ and $\bm{\vec{\omega_{E}}}$ are the angular velocity vectors of the inclined satellite orbit and the spin of the Earth.
Finally, the sub-satellite velocity figure can be solved based on the scalar angular velocity by applying equation (\ref{eq-ang-vel-2}), as the altitude of the airborne platform $h_{air}$ and the mean radius of the Earth $R_E$ are known.

\begin{equation}
  v_{air} = \omega_{ECF}\ (h_{air} + R_E)
\end{equation}

\begin{figure}[h]
  \centering
  \input{tikz_figures/fig-subsat-velocity-inclined.tikz}
  \caption{Sub-satellite velocity (m/s) as a function of orbital altitude (m) and inclination (rad KORJAA ASTEET).} % TODO: korjaa asteiksi 
  \label{fig-subsat-velocity-inclined}
\end{figure}

\subsection{Sub-model 3: Listening window}

Listening window is the time that an airborne eavesdropper is able to intercept the uplink RF transmission from a user terminal on the ground.
Analysing this window is somewhat more complex in terms of the model required and potential input parameters that need to be considered.
On a high level, the window is primarily influenced by the relative motion between the uplink RF beam of the terminal and the kinematic characteristics of the airborne eavesdropper.
The latter include qualities such as cruise speed, operational altitude, manoeuvrability and controllability.
They define the ability of the aircraft to keep a lock on the moving RF beam.
These are in turn defined by the characteristics of the platform, a topic discussed in more detail in section \ref{sect-aerial-platforms}.
As demonstrated by the inclination-orbital altitude analysis, aircraft kinematics have very little effect at LEO satellite altitudes ranging from hundreds to couple thousand kilometers. In practice, the great disparity between the velocities makes it possible to abstract away the movement of the aircraft and assume it to be stationary for the sake of analysis.

Assuming a stationary eavesdropper, the listening window ${t_{pass}}$ can be computed by dividing the beamwidth of the satellite terminal $\theta_{beam}$ with the angular velocity of the satellite in the ECF coordinate frame $\omega_{ECF}$.

\begin{equation}
  t_{pass} = \frac{\theta_{beam}}{\omega_{ECF}}
\end{equation}

Evaluation in smaller domain, $T_{orbit} = [5400, 42400]$. Around GEO grows to infinity as the sub-satellite velocity matches the aircraft's velocity as the satellite fixed in the sky.
\begin{figure}[h]
  \centering
  \input{tikz_figures/fig-listening-window.tikz}
  \caption{Listening window (s) as a function of orbital altitude (m) (korjaa metreiksi) and inclination (rad KORJAA ASTEET).} % TODO: korjaa asteiksi 
  \label{fig-listening-window}
\end{figure}

\subsection{Sub-model 4: Jamming link budget}
Jamming relies on the deliberately weakening of the useful signal in relation to prevailing noise floor and interference. In situations where the jamming dominates over the natural noise sources, the relationship can be simplified to a signal-to-jamming ratio (SJR). In low signal power scenarios, noise sources need to be also accounted for leading to the term of signal-to-noise+jamming ratio (SJNR). \cite{kosola2013digitaalinen}

\begin{equation*}
  \text{SJR} = \frac{S}{J} \qquad
  \text{SJNR} = \frac{S}{J+N}
\end{equation*}

Transmission and jamming power levels $S$ and $J$ at the receiver can be calculated from the following equations.

\begin{equation}
  S = P_t + G_{tr}-L_t-L_{tr}(R_{tr})+G_{rt}-L_r \qquad \text{[dBW]}
\end{equation}

\begin{equation}
  J = P_j + G_{jr}-L_j-L_{jr}(R_{jr})+G_{rj}-L_r \qquad \text{[dBW]}
\end{equation}

In some cases, jammer may even be at an advantage based on their geographical location through a shorter signal path and smaller free space path loss, as demonstrated in \cite{pavur2022defcon}.
Minimum CNR requirements for modulation and coding schemes (modcod) determine the ability of the jammer to interfere with the legitimate transmission.
As discussed in chapter \ref{ch-oneweb}, OneWeb uses adaptive modcod scheme comprised of QPSK, 8PSK and 16-QAM modulation techniques. Higher end requires significantly greater CNR at the receiver, while the lower end can still function even with very low CNR, if significant forward error correction (FEC) is utilised. \cite{allen2022terrestrial,etsi2012en302307}

Jamming of the uplink signal can be done from both aircraft and earth-bound platforms.

% Downlink
% When it comes to jamming, two main scenarios arise. The jammer can either be in the rough area of the main beam or elsewhere, which leads to different gain figures at the receiver's end. This means that the jammer is either transmitting in the receiver's main lobe, side lobe or nulls between these. While the latter can be simply be ruled out due to the high attenuation, the two prior provide a chance for the jammer to interfere with the legitimate transmission. Side lobe level (SLL) of the modern constellations is not known for both the satellites and the terminals. We can though estimate it based on constraints like the ITU radio regulations, which set inherent limits for the maximum allowable power flux density to limit interference. In \cite{hills2023controlling}, the authors estimated maximum allowable sidelobe levels for the first generation Starlink and OneWeb constellations at $-32.9$ and \qty{-24.0}{\decibel} respectively.

Choose acceptable SJR level

Vary EIRP or jammer and SLL of the receiver

Effect of large number of satellites, switching beams. Predictability of frequency pattern -> effect on the jammer?

End-to-end performance of a communications link can be analysed through a link budget that is a theoretical calculation where gains and losses of a RF system summed with each other in order to compute suitable figures of merit that can be in turn used to characterise the theoretical
Table \ref{table-ul-jamming-link-budget} presents an uplink link budget for the Kymeta Hawk u8 UT interfacing with the OneWeb LEO megaconstellation.
Parameters of the UT are taken from \cite{kymeta2022hawk} and \cite{kymeta2020mod}, while parameters for the space segment of the OneWeb constellation are based on the values in \cite{worldvu2016loi} and \cite{allen2022terrestrial} for the first generation constellation.
For the advantage of the legitimate user, the modcod scheme is assumed to be the less demanding QPSK with $1/2$ FEC.

\begin{table}[h]
  \centering
  \caption{Uplink jamming link budget for Kymeta Hawk u8 flat panel terminal interfacing with the OneWeb LEO constellation.}
  \begin{tabular}{@{}lrl@{}}
    \toprule
    Parameter                             & Value     & Notes         \\ \midrule
                                          &           &               \\
    Constants                             &           &               \\ \midrule
    Athmospheric loss {[}dB{]}            & 0.35      &               \\
    Bolzmann‚Äôs constant {[}dBW/K/Hz{]}    & -228.60   &               \\
    Speed of light {[}m/s{]}              & 3.00E+08  &               \\
                                          &           &               \\
    Satellite parameters                  &           &               \\ \midrule
    Transponder bandwidth, RX {[}MHz{]}   & 120.00    &               \\
    Path distance {[}km{]}                & 1,200.00  &               \\
    G/T at satellite‚Äôs RX {[}dB/K{]}      & 11.40     &               \\
    Target SNR {[}dB{]}                   & 1.00      & QPSK, 1/2 FEC \\
                                          &           &               \\
    User terminal parameters              &           &               \\ \midrule
    Frequency {[}MHz{]}                   & 14,000.00 &               \\
    Broadside EIRP {[}dBW{]}              & 46.50     &               \\
    Channel bandwidth {[}MHz{]}           & 20.00     &               \\
                                          &           &               \\
    Computed values                       &           &               \\ \midrule
    Free space path loss {[}dB{]}         & 176.95    &               \\
    Channel bandwidth {[}dBHz{]}          & 73.01     &               \\
    Received power @ sat {[}dB{]}         & -192.41   &               \\
    Required jamming power @ sat {[}dB{]} & -193.41   & $J \gg N$     \\ \bottomrule
    \label{table-ul-jamming-link-budget}
  \end{tabular}
\end{table}

The computations show that the jammer needs to achieve \SI{1}{\deci\bel} smaller signal power at the satellite than the legitimate transmitter, meaning still a certain degree of advantage to the jammer at even the baseline scenario.


\section{Discussion}
\subsubsection{Eavesdropping}
% Ylen artikkeli ven√§j√§n radalla olevista GEO-kuuntelusta, vrt. ikkunan pituuteen ja liiketekij√∂ihin.
\subsubsection{Jamming}
\subsubsection{Radiolocation}


T\"ass\"a osassa esitet\"a\"an tulokset ja vastataan tutkielman alussa
esitettyihin tutkimuskysymyksiin.
Tieteellisen kirjoitelman
arvo mitataan t\"ass\"a osassa esitettyjen tulosten perusteella.

%% Huomaa seuraavassa kappaleessa lainausmerkkien ulkopuolella piste, 
%% koska piste ei lopeta lainattua tekstinp\"atk\"a\"a.
%% Jos lainattu tekstinp\"atk\"a loppuu v\"alimerkkiin, tulee v\"alimerkki
%% lainausmerkkien sis\"alle: 
%% "Et tu, Brute?" sanoi Caesar kuollessaan.
Tutkimustuloksien merkityst\"a on aina syyt\"a arvioida ja tarkastella
kriittisesti.  Joskus tarkastelu voi olla t\"ass\"a osassa, mutta se
voidaan my\"os j\"att\"a\"a viimeiseen osaan, jolloin viimeisen osan nimeksi
tulee >>Tarkastelu>>. Tutkimustulosten merkityst\"a voi arvioida my\"os
>>Johtop\"a\"at\"okset>>-otsikon alla viimeisess\"a osassa.

T\"ass\"a osassa on syyt\"a my\"os arvioida tutkimustulosten luotettavuutta.
Jos tutkimustulosten merkityst\"a arvioidaan >>Tarkastelu>>-osassa,
voi luotettavuuden arviointi olla my\"os siell\"a.

\clearpage

\section{Conclusion}

In recent years, the satellite communications industry has witnessed a paradigm shift with the rise of large NGSO megaconstellations.
The proliferation of these constellations, facilitated by reduced space launch costs and COTS technology, has opened new frontiers of connectivity.
However, this rapid evolution has not been without challenges, particularly in the area of cybersecurity.

The absence of widely accepted cybersecurity standards and the proprietary nature of technical solutions leave open potential vulnerabilities, while the wide-area broadcast nature of satellite transmissions makes them susceptible to eavesdropping and other adversarial actions from a wide geographic footprint.
Adversarial groups, including state actors and individual enthusiasts armed with accessible Software-Defined Radios (SDR), have demonstrated the feasibility of intercepting satellite traffic.

To better understand the underlying security aspects of emerging NGSO VSAT networks, this thesis focused on assessing the risks posed by airborne eavesdroppers to the uplink communications from satellite terminals on the ground.
Through geometric and kinematic analysis, as well as link budgets based on typical hardware configurations, the resilience of LEO broadband systems was explored.

The unique attributes of the space environment, in which the satellite's space segment resides, give certain advantages to the LEO systems.
Orbital motion of the satellites in LEO limits the listening window for communication interception, necessating large-scale collusion between eavesdroppers for effective COMINT.
Additionally, the radio horizon  arising from higher minimun elevation angles in VSATs imposes further constraints on eavesdroppers, requiring them to approach relatively close to transmitting terminals for effective uplink interception.

On the other hand, using lower orbits leads to certain disadvantages.
While higher orbits like GEO require the eavesdropper to transmit at equivalent EIRP levels compared to the legitimate transmitter, the lower altitude of LEO introduces situations where jamming or hijacking the legitimate signal is possible to achieve even with relatively simple and inexpensive radio hardware, such as COTS SDRs and satellite TV equipment.
Despite the relative ease of raw jamming, sophisticated spoofing attacks tend to be more difficult to achieve. Here, contributing factors are the complex and often obscure nature of satellite systems.
It is worth noting that commercial broadband systems have been moving towards more standardised solutions in the recent years. 

Public safety and defence users place more stringent requirements on their communication solutions when compared to commericial consumer and entreprise systems.
Clear understanding of the control and ownership, as well as robust security measures, be they physical or cyber in nature, are the root prerequisites for the adoption of any new system or solution.
Considering the results gained from the examination of the model, the emerging NGSO satellite networks do not have inherent physical flaws that would directly jeopardise the security of these systems.
In fact and as discussed, compared to their predecessors, the NGSO systems have some inherent qualities that make them rather robust against a multitude of the potential threat factors.

Security of commercial satellite systems is a rather young field of study and much work remains for future researchers. Concerning the commercial broadband networks, approaches such as practical waveform studies through open-source black-box reverse engineering is one interesting approach. Robustness of physical and network security of the gateways is another interesting topic with less attention in the research literature.

%- TODO: orbital motion in leo -> limits the listening window to minutes -> comint very difficult with individual receivers, requires large scale collusion between receivers and large data transfers

%- radio horizon of a VSAT terminal -> high minumum elevation angle requires the eavesdropper to fly relatively close to the terminal (tens to hundreds of km)

%- wideband nature of the waveform -> higher end receiving equipment for signal capture.

%- jamming. low rf power means that uplink transmissions can be jammed with relatively simple hardware thanks to the geometry of the problem. Spoofing more difficult especially thanks to the obscure nature of these systems.

%Recommendations

% migraatio, leo backup / peitto -> PS vaatimukset
% MNO consumer vs entreprise vaatimukset?

\clearpage
%% L\"ahdeluettelo

\thesisbibliography

\bibliographystyle{ieeetran}
\bibliography{main}

%% Appendices
%% If you don't have appendices, remove \clearpage and \thesisappendix below.
\clearpage

\thesisappendix

%\newgeometry{margin={1.5in,0in}}

%\thispagestyle{empty}
\begin{landscape}
\section{Appendix: Comparison of broadband satellite systems\label{appendix-constellation-comparison}}

\begin{table}[h]
  \centering
  \makebox[0pt][c]{
  \begin{tabular}{@{}lllllllll@{}}
  \toprule
  \multicolumn{1}{c}{Operator} &
    \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}Frequency\\ band\end{tabular}} &
    \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}Number of\\ satellites,\\ ph. 1\\ (launced /\\ planned)\end{tabular}} &
    \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}Number of\\ satellites,\\ ph. 2\\ (launced /\\ planned)\end{tabular}} &
    \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}Orbital altitude\\ (km)\end{tabular}} &
    \multicolumn{1}{c}{Mass of a satellite (kg)} &
    \multicolumn{1}{c}{UT datarate} &
    \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}Satellite\\ throughput\end{tabular}} &
    \multicolumn{1}{c}{\begin{tabular}[c]{@{}c@{}}Country\\ of\\ origin\end{tabular}} \\ \midrule
  \begin{tabular}[c]{@{}l@{}}Amazon\\ Kuiper\end{tabular} &
    Ka &
    0 / 548 &
    0 / 3236 &
    590-630 &
     &
    400 Mbps in tests &
     &
    US \\
  OneWeb &
    Ku, Ka &
    648 / 648 &
    0 / 6372 &
    1200 &
    150 &
     &
    10 Gbps &
    UK \\ \addlinespace[0.5em]
  \begin{tabular}[c]{@{}l@{}}SpaceX\\ Starlink\end{tabular} &
    \begin{tabular}[c]{@{}l@{}}Ku, Ka\\ V, E, S\end{tabular} &
    x / 4408 &
    0 / 7518 &
    \begin{tabular}[c]{@{}l@{}}$\sim$550 (ph. 1),\\ $\sim$350 (ph. 2)\end{tabular} &
    270-TODO &
    150 / 15 Mbps &
     &
    US \\ \addlinespace[0.5em]
  \begin{tabular}[c]{@{}l@{}}Telesat\\ Lightspeed\end{tabular} &
    Ka &
    0 / 298 &
    0 / 1671 &
    1015, 1325 &
    700 &
    \begin{tabular}[c]{@{}l@{}}7.5 Gbps UT,\\ 20 Gbps "hotspot"\end{tabular} &
     &
    Canada \\ \addlinespace[0.5em]
  \begin{tabular}[c]{@{}l@{}}AST\\ SpaceMobile\end{tabular} &
    S, V &
    0 / 20 &
    0 / 223 &
    700 &
    1500 &
    35 / 3 Mbps &
     &
    US \\ \addlinespace[0.5em]
  Lynk &
    S &
    0 / 5000 &
     &
    500 &
    85 &
     &
     &
    US \\ \addlinespace[0.5em]
  \begin{tabular}[c]{@{}l@{}}Iridium\\ NEXT\end{tabular} &
    L &
    75 / 66 &
     &
    780 &
    680 &
     &
     &
    US \\ \bottomrule
  \end{tabular}
  }
\end{table}

\end{landscape}


\clearpage
\section{Appendix: Matlab code\label{appendix-matlab-code}}

KOODI T√ÑH√ÑN

\end{document}
